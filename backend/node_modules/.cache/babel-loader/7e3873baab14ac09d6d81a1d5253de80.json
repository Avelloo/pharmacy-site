{"ast":null,"code":"import _objectSpread from\"C:/Users/aloob/Desktop/pharmacy-site/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{Link}from\"react-router-dom\";import{createOrder}from\"../actions/orderActions\";import CheckoutSteps from\"../components/CheckoutSteps\";import{ORDER_CREATE_RESET}from\"../constants/orderConstants\";import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PlaceOrderScreen(props){var cart=useSelector(function(state){return state.cart;});if(!cart.paymentMethod){props.history(\"/payment\");}var orderCreate=useSelector(function(state){return state.orderCreate;});var loading=orderCreate.loading,success=orderCreate.success,error=orderCreate.error,order=orderCreate.order;var toPrice=function toPrice(num){return Number(num.toFixed(2));};// 5.123 => \"5.12\" => 5.12\ncart.itemsPrice=toPrice(cart.cartItems.reduce(function(a,c){return a+c.qty*c.price;},0));cart.shippingPrice=cart.itemsPrice>600?toPrice(0):toPrice(150);cart.totalPrice=cart.itemsPrice+cart.shippingPrice;var dispatch=useDispatch();var placeOrderHandler=function placeOrderHandler(){dispatch(createOrder(_objectSpread(_objectSpread({},cart),{},{orderItems:cart.cartItems})));};useEffect(function(){if(success){props.history.push(\"/order/\".concat(order._id));dispatch({type:ORDER_CREATE_RESET});}},[dispatch,order,props.history,success]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"row top center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-2\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0414\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0430\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0424\\u0418\\u041E:\"}),/*#__PURE__*/_jsx(\"br\",{}),\" \",cart.shippingAdress.fullName,\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0410\\u0434\\u0440\\u0435\\u0441:\"}),/*#__PURE__*/_jsx(\"br\",{}),\" \",cart.shippingAdress.adress,\",\",/*#__PURE__*/_jsx(\"br\",{}),cart.shippingAdress.city,\",\",/*#__PURE__*/_jsx(\"br\",{}),\" \",cart.shippingAdress.postalCode,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430:\"}),/*#__PURE__*/_jsx(\"br\",{}),\" +\",cart.shippingAdress.phoneNumber]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041C\\u0435\\u0442\\u043E\\u0434 \\u043E\\u043F\\u043B\\u0430\\u0442\\u044B\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041C\\u0435\\u0442\\u043E\\u0434:\"}),cart.paymentMethod]})]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body card-payment\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"h2block\",children:\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430:\"}),/*#__PURE__*/_jsx(\"ul\",{children:cart.cartItems.map(function(item){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row row-left\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,className:\"small\"}),/*#__PURE__*/_jsx(\"div\",{className:\"min-30\",children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(\"div\",{children:[item.qty,\" x \",item.price,\" = \",item.qty*item.price,\" \\u0420\\u0443\\u0431.\"]})]})},item.product);})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card card-body\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0421\\u0443\\u043C\\u043C\\u0430:\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0422\\u043E\\u0432\\u0430\\u0440\\u044B\"}),/*#__PURE__*/_jsxs(\"div\",{children:[cart.itemsPrice,\" \\u0420\\u0443\\u0431.\"]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0414\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{children:[cart.shippingPrice,\" \\u0420\\u0443\\u0431.\"]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0418\\u0442\\u043E\\u0433\\u043E:\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[cart.totalPrice,\" \\u0420\\u0443\\u0431.\"]})})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:placeOrderHandler,disabled:cart.cartItems.length===0,children:\"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"})}),loading&&/*#__PURE__*/_jsx(LoadingBox,{}),error&&/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error})]})})})]})]});}","map":{"version":3,"sources":["C:/Users/aloob/Desktop/pharmacy-site/frontend/src/screens/PlaceOrderScreen.js"],"names":["React","useEffect","useDispatch","useSelector","Link","createOrder","CheckoutSteps","ORDER_CREATE_RESET","LoadingBox","MessageBox","PlaceOrderScreen","props","cart","state","paymentMethod","history","orderCreate","loading","success","error","order","toPrice","num","Number","toFixed","itemsPrice","cartItems","reduce","a","c","qty","price","shippingPrice","totalPrice","dispatch","placeOrderHandler","orderItems","push","_id","type","shippingAdress","fullName","adress","city","postalCode","phoneNumber","map","item","image","name","product","length"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { createOrder } from \"../actions/orderActions\";\nimport CheckoutSteps from \"../components/CheckoutSteps\";\nimport { ORDER_CREATE_RESET } from \"../constants/orderConstants\";\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\n\nexport default function PlaceOrderScreen(props) {\n  const cart = useSelector((state) => state.cart);\n  if (!cart.paymentMethod) {\n    props.history(\"/payment\");\n  }\n\n  const orderCreate = useSelector((state) => state.orderCreate);\n  const { loading, success, error, order } = orderCreate;\n  const toPrice = (num) => Number(num.toFixed(2)); // 5.123 => \"5.12\" => 5.12\n  cart.itemsPrice = toPrice(\n    cart.cartItems.reduce((a, c) => a + c.qty * c.price, 0)\n  );\n  cart.shippingPrice = cart.itemsPrice > 600 ? toPrice(0) : toPrice(150);\n  cart.totalPrice = cart.itemsPrice + cart.shippingPrice;\n  const dispatch = useDispatch();\n  const placeOrderHandler = () => {\n    dispatch(createOrder({ ...cart, orderItems: cart.cartItems }));\n  };\n  useEffect(() => {\n    if (success) {\n      props.history.push(`/order/${order._id}`);\n      dispatch({ type: ORDER_CREATE_RESET });\n    }\n  }, [dispatch, order, props.history, success]);\n  return (\n    <div>\n      <CheckoutSteps step1 step2 step3 step4></CheckoutSteps>\n      <div className=\"row top center\">\n        <div className=\"col-2\">\n          <ul>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Доставка</h2>\n                <p>\n                  <strong>ФИО:</strong>\n                  <br /> {cart.shippingAdress.fullName} <br />\n                  <strong>Адрес:</strong>\n                  <br /> {cart.shippingAdress.adress},<br />\n                  {cart.shippingAdress.city},<br />{\" \"}\n                  {cart.shippingAdress.postalCode}\n                  <br />\n                  <strong>Номер телефона:</strong>\n                  <br /> +{cart.shippingAdress.phoneNumber}\n                </p>\n              </div>\n            </li>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Метод оплаты</h2>\n                <p>\n                  <strong>Метод:</strong>\n                  {cart.paymentMethod}\n                </p>\n              </div>\n            </li>\n          </ul>\n        </div>\n        <div className=\"col-1\">\n          <div className=\"card card-body card-payment\">\n            <h2 className=\"h2block\">Корзина:</h2>\n            <ul>\n              {cart.cartItems.map((item) => (\n                <li key={item.product}>\n                  <div className=\"row row-left\">\n                    <img\n                      src={item.image}\n                      alt={item.name}\n                      className=\"small\"\n                    ></img>\n\n                    <div className=\"min-30\">\n                      <Link to={`/product/${item.product}`}>{item.name}</Link>\n                    </div>\n                    <div>\n                      {item.qty} x {item.price} = {item.qty * item.price} Руб.\n                    </div>\n                  </div>\n                </li>\n              ))}\n            </ul>\n          </div>\n        </div>\n        <div className=\"col-1\">\n          <div className=\"card card-body\">\n            <ul>\n              <li>\n                <h2>Сумма:</h2>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>Товары</div>\n                  <div>{cart.itemsPrice} Руб.</div>\n                </div>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>Доставка</div>\n                  <div>{cart.shippingPrice} Руб.</div>\n                </div>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>\n                    <strong>Итого:</strong>\n                  </div>\n                  <div>\n                    <strong>{cart.totalPrice} Руб.</strong>\n                  </div>\n                </div>\n              </li>\n              <li>\n                <button\n                  type=\"button\"\n                  onClick={placeOrderHandler}\n                  disabled={cart.cartItems.length === 0}\n                >\n                  Оплатить заказ\n                </button>\n              </li>\n              {loading && <LoadingBox></LoadingBox>}\n              {error && <MessageBox variant='danger'>{error}</MessageBox>}\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}